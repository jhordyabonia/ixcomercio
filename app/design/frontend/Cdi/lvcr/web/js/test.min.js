var fieldCityCheckout,$=jQuery;function getStatesCheckout(n){$("body").trigger("processStart"),$(n).find('input[name="postcode"]').val("");var o=$(n).find("> .field.street .control .additional .control"),d=$(n).find('> .field select[name="custom_attributes[zone_id]"]');$(d).attr("disabled",!0),$(o).find("input").hide(),fieldCityCheckout=$(n).find('> .field input[name="city"]').parent(),$.ajax({url:"/places/search/",type:"GET",dataType:"json",success:function(t){if($(fieldStateCheckout).find("input").length){$(fieldStateCheckout).find("input").hide();var i='<select id="fieldStateCheckout" class="select" name="state_id" aria-required="true" aria-invalid="false"><option data-title="" value="">Please select a region, state or province.</option>';$.each(t,function(e,t){i+="<option value='' parentid='"+t.Id+"''>"+t.Name+"</option>"}),i+="</select>",$(fieldStateCheckout).append(i)}else{var e=$(fieldStateCheckout).find("select option");$.each(e,function(e,i){var a=$(i).text();$.each(t,function(e,t){t.Name==a&&($(i).attr("parentId",t.Id),$(i).show())})})}$(fieldCityCheckout).find("input").hide();$(fieldCityCheckout).append('<select id="fieldCityCheckout" class="select" name="cities_id" aria-required="true" aria-invalid="false" disabled><option data-title="" value="">Please select a city.</option></select>'),$("body").trigger("processStop");var a=$(fieldStateCheckout).find("select");$(a).on("change",function(e){$("body").trigger("processStart"),$(n).find('input[name="postcode"]').val(""),$.ajax({url:"/places/search/",data:"parentId="+$(a).find("option:selected").attr("parentId"),type:"GET",dataType:"json",success:function(e){$(fieldCityCheckout).find("select").attr("disabled",!1),$(fieldCityCheckout).find('select option:not([value=""])').remove(),$.each(e,function(e,t){$(fieldCityCheckout).find("select").append("<option value='"+t.Id+"' parentId='"+t.Id+"'>"+t.Name+"</option>")}),$("body").trigger("processStop")}});var t=$(fieldStateCheckout).find("select option:selected");$(fieldStateCheckout).find("input").val($(t).text()),$(fieldStateCheckout).find("input").keyup()}),$(n).find("#fieldCityCheckout").on("change",function(e){$("body").trigger("processStart"),$(n).find('input[name="postcode"]').val("");var t=$(fieldCityCheckout).find("select option:selected");$(fieldCityCheckout).find("input").val($(t).text()),$(fieldCityCheckout).find("input").keyup(),$.ajax({url:"/places/search/",data:"parentId="+$(this).find("option:selected").attr("parentId"),type:"GET",dataType:"json",success:function(e){$(d).attr("disabled",!1),$(d).find("option").remove(),$(d).append('<option data-title="" value="" selected>Please select a zone.</option>'),$.each(e,function(e,t){$(d).append("<option value='"+t.ParentId+"' parentId='"+t.ParentId+"' postalCode='"+t.PostalCode+"'>"+t.Name+"</option>")}),$("body").trigger("processStop")}})}),$(n).find('select[name="custom_attributes[zone_id]"]').on("change",function(e){$("body").trigger("processStart");var t=$(this).find("option:selected");$(o).find("input").val($(t).text()),$(o).find("input").keyup(),"null"!=$(t).attr("postalCode")?$('input[name="postcode"]').val($(t).attr("postalCode")):$('input[name="postcode"]').val($(t).text()),$('input[name="postcode"]').keyup(),$("body").trigger("processStop")})}})}$('input[name="billing-address-same-as-shipping"]').on("change",function(e){var t;0==$(this).prop("checked")&&(t=$('form fieldset[data-form="billing-new-address"] input[name="region"]').parent(),1<=$(t).length&&getStatesCheckout($('form fieldset[data-form="billing-new-address"]')))});